version: 1.0.{build}
platform: 
  - x86
  - x64
configuration:
  - Debug
  - Release
environment:
  my_var1: value1
  my_var2: value2
 # matrix:
    - my_var3: value3
    - my_var4: value4
test_script:
  - ps: write-host "common/default test script"
  - ps: Write-Host "my_var1:" $env:my_var1 "my_var2:" $env:my_var2
build_script:
  - echo "common/default build script"
for:
  -
    matrix:
      only: 
        - configuration: Release
          my_var3: value3
    environment:
      my_var3: overridden-value3
    platform: Any CPU
    test_script:
      - ps: write-host "for-matrix override test script"
      - ps: write-host $env:platform $env:my_var1 $env:my_var2

  -
    matrix:
      only:
        - configuration: Debug
          my_var4: value4
    environment:
      my_var4: overridden-value4
    build_script:
      - cmd: echo "for-matrix override build script"
      - ps: write-host $env:platform $env:my_var1 $env:my_var2

  -
    matrix:
      exclude:
        - configuration: Debug
          my_var4: overridden-value4
